{"version":3,"file":"authhelper.js","sourceRoot":"","sources":["../../../src/authentication/authhelper.js"],"names":[],"mappings":"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","sourcesContent":["export function AuthHelper() {\n  var loginDialog;\n  var parentcallback;\n\n  this.DialogFallback = async (_pcallback) => {\n    parentcallback = _pcallback;\n    // We fall back to Dialog API for any error.\n    const url = \"/login.html\";\n    // Office.onReady().then(r=>{\n    ShowLoginPopup(url);\n\n    // })\n    //const tk=await OfficeRuntime.auth.getAccessToken();\n    //GetGraphData(tk);\n  };\n\n  var ShowLoginPopup = (url) => {\n    var fullUrl =\n      window.location.protocol +\n      \"//\" +\n      window.location.hostname +\n      (window.location.port ? \":\" + window.location.port : \"\") +\n      url;\n    var _this = this;\n\n    Office.context.ui.displayDialogAsync(fullUrl, { height: 60, width: 30 }, function (result) {\n      loginDialog = result.value;\n      loginDialog.addEventHandler(Office.EventType.DialogMessageReceived, ProcessMessage);\n    });\n  };\n\n  var ProcessMessage = async (arg) => {\n    console.log(\"proc message\");\n    logger.log(\"Message received in processMessage: \" + JSON.stringify(arg));\n\n    let messageFromDialog = JSON.parse(arg.message);\n    loginDialog.close();\n\n    if (messageFromDialog.status === \"success\") {\n      // We now have a valid access token.\n      try {\n        logger.log(\"final call back: \" + messageFromDialog.result);\n        //GetGraphData(messageFromDialog.result);\n        if (parentcallback) {\n          logger.log(\"got parent call back\");\n          parentcallback(messageFromDialog.result, null);\n        } else logger.log(\"parent call back null\");\n      } catch (ex1) {\n        logger.log(ex1);\n        if (parentcallback) parentcallback(null, ex1);\n        else logger.log(\"parent call back null ex1\");\n      }\n    } else {\n      //this.loginDialog.close();\n      if (parentcallback) parentcallback(null, messageFromDialog);\n      else logger.log(\"parent call back failure\");\n    }\n  };\n}\n\nvar logger = {};\n\nlogger.log = async (logmsg, logobj) => {\n  try {\n    //console.log(logmsg,logobj);\n    if (logobj) logmsg = logmsg + \": \" + JSON.stringify(logobj);\n    // if (Object.prototype.toString.call(logmsg) === '[object Object]')\n    // logmsg=JSON.stringify(logmsg);\n  } catch (err) {\n    console.log(\"eeror in logger\", err);\n  }\n};\n"]}