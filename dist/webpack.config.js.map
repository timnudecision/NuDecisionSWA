{"version":3,"file":"webpack.config.js","sourceRoot":"","sources":["../webpack.config.js"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable no-undef */\n\nconst CopyWebpackPlugin = require(\"copy-webpack-plugin\");\nconst HtmlWebpackPlugin = require(\"html-webpack-plugin\");\nconst nodeExternals = require(\"webpack-node-externals\");\n\nconst urlDev = \"https://localhost:3000/\";\nconst urlProd = \"https://orange-water-0d260d810.3.azurestaticapps.net/\"; // CHANGE THIS TO YOUR PRODUCTION DEPLOYMENT LOCATION\n\nmodule.exports = async (env, options) => {\n  const dev = options.mode === \"development\";\n  const config = [\n    {\n      devtool: \"source-map\",\n      entry: {\n        polyfill: [\"core-js/stable\", \"regenerator-runtime/runtime\"],\n        taskpane: [\"./src/taskpane/taskpane.ts\", \"./src/taskpane/taskpane.html\"],\n        mainpane: \"./src/taskpane/mainpane.ts\",\n        commands: \"./src/commands/commands.js\",\n        login: \"./src/authentication/login.js\",\n        fallbackauthdialog: \"./src/helpers/fallbackauthdialog.js\",\n      },\n      resolve: {\n        extensions: [\".html\", \".js\"],\n        fallback: {\n          buffer: require.resolve(\"buffer/\"),\n          http: require.resolve(\"stream-http\"),\n          https: require.resolve(\"https-browserify\"),\n          url: require.resolve(\"url/\"),\n        },\n      },\n      module: {\n        rules: [\n          {\n            test: /\\.js$/,\n            exclude: /node_modules/,\n            use: {\n              loader: \"babel-loader\",\n              options: {\n                presets: [\"@babel/preset-env\"],\n              },\n            },\n          },\n          {\n            test: /\\.html$/,\n            exclude: /node_modules/,\n            use: \"html-loader\",\n          },\n          {\n            test: /\\.(png|jpg|jpeg|gif|ico)$/,\n            type: \"asset/resource\",\n            generator: {\n              filename: \"assets/[name][ext][query]\",\n            },\n          },\n        ],\n      },\n      plugins: [\n        new HtmlWebpackPlugin({\n          filename: \"taskpane.html\",\n          template: \"./src/taskpane/taskpane.html\",\n          chunks: [\"polyfill\", \"taskpane\"],\n        }),\n        new HtmlWebpackPlugin({\n          filename: \"mainpane.html\",\n          template: \"./src/taskpane/mainpane.html\",\n          chunks: [\"polyfill\", \"mainpane\"],\n        }),\n        new HtmlWebpackPlugin({\n          filename: \"commands.html\",\n          template: \"./src/commands/commands.html\",\n          chunks: [\"polyfill\", \"commands\"],\n        }),\n        new HtmlWebpackPlugin({\n          filename: \"fallbackauthdialog.html\",\n          template: \"./src/helpers/fallbackauthdialog.html\",\n          chunks: [\"polyfill\", \"fallbackauthdialog\"],\n        }),\n        new HtmlWebpackPlugin({\n          filename: \"login.html\",\n          template: \"./src/authentication/login.html\",\n          chunks: [\"polyfill\", \"login\"],\n        }),\n        new HtmlWebpackPlugin({\n          filename: \"index.html\",\n          template: \"./src/taskpane/taskpane.html\",\n          chunks: [\"polyfill\", \"taskpane\"],\n        }),\n        new CopyWebpackPlugin({\n          patterns: [\n            {\n              from: \"assets/*\",\n              to: \"assets/[name][ext][query]\",\n            },\n            {\n              from: \"manifest*.xml\",\n              to: \"[name]\" + \"[ext]\",\n              transform(content) {\n                if (dev) {\n                  return content;\n                } else {\n                  return content.toString().replace(new RegExp(urlDev, \"g\"), urlProd);\n                }\n              },\n            },\n          ],\n        }),\n      ],\n    },\n    {\n      devtool: \"source-map\",\n      target: \"node\",\n      entry: {\n        middletier: \"./src/middle-tier/app.js\",\n      },\n      output: {\n        clean: true,\n      },\n      externals: [nodeExternals()],\n      resolve: {\n        extensions: [\".js\"],\n      },\n      module: {\n        rules: [\n          {\n            test: /\\.js$/,\n            exclude: /node_modules/,\n            use: {\n              loader: \"babel-loader\",\n              options: {\n                presets: [\"@babel/preset-env\"],\n              },\n            },\n          },\n        ],\n      },\n      plugins: [\n        new CopyWebpackPlugin({\n          patterns: [\n            {\n              from: \".env\",\n              to: \".\",\n            },\n          ],\n        }),\n      ],\n    },\n  ];\n\n  return config;\n};\n"]}